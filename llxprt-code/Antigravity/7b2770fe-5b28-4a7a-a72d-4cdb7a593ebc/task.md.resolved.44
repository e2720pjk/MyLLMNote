# Task: Review UI Alignment between llxprt-code-3 and gemini-cli

## Status
- [/] List and compare UI component files in both projects <!-- id: 0 -->
- [x] Compare [DefaultAppLayout.tsx](file:///Users/caishanghong/Shopify/cli-tool/llxprt-code-3/packages/cli/src/ui/layouts/DefaultAppLayout.tsx) structure <!-- id: 1 -->
- [/] Compare [App.tsx](file:///Users/caishanghong/Shopify/cli-tool/gemini-cli/packages/cli/src/ui/App.tsx) / [gemini.tsx](file:///Users/caishanghong/Shopify/cli-tool/gemini-cli/packages/cli/src/gemini.tsx) provider stack (re-verify) <!-- id: 2 -->
- [x] Compare key components ([InputPrompt](file:///Users/caishanghong/Shopify/cli-tool/llxprt-code-3/packages/cli/src/ui/components/InputPrompt.tsx#97-1047), [HistoryItemDisplay](file:///Users/caishanghong/Shopify/cli-tool/gemini-cli/packages/cli/src/ui/components/HistoryItemDisplay.tsx#47-161), `Tool*Message`) <!-- id: 3 -->
- [x] Identify missing or mismatched components/logic <!-- id: 4 -->
- [x] Report findings to user <!-- id: 5 -->
- [x] Port `useMouseClick` hook if missing (Already exists) <!-- id: 6 -->
- [x] Update [InputPrompt.tsx](file:///Users/caishanghong/Shopify/cli-tool/gemini-cli/packages/cli/src/ui/components/InputPrompt.tsx) with mouse interaction logic <!-- id: 7 -->
- [x] Update [Composer.tsx](file:///Users/caishanghong/Shopify/cli-tool/gemini-cli/packages/cli/src/ui/components/Composer.tsx) to pass `isEmbeddedShellFocused` <!-- id: 8 -->
- [x] Verify fixes <!-- id: 9 -->
- [x] Align Input UI with `gemini-cli` (InputPrompt, AppContainer, Composer) <!-- id: 24 -->
- [x] Fix history persistence on resize (Restored `key={uiState.staticKey}` to align with `gemini-cli`) <!-- id: 10 -->
- [x] Address PR Review Feedback <!-- id: 11 -->
    - [x] [packages/cli/src/ui/utils/color-utils.ts](file:///Users/caishanghong/Shopify/cli-tool/llxprt-code-3/packages/cli/src/ui/utils/color-utils.ts): Add validation to [interpolateColor](file:///Users/caishanghong/Shopify/cli-tool/gemini-cli/packages/cli/src/ui/themes/color-utils.ts#236-254)
    - [x] [packages/cli/src/ui/components/messages/ToolMessage.tsx](file:///Users/caishanghong/Shopify/cli-tool/gemini-cli/packages/cli/src/ui/components/messages/ToolMessage.tsx): Check `AnsiOutput` casting and remove `@ts-expect-error`
    - [x] [packages/cli/src/ui/components/messages/ShellToolMessage.tsx](file:///Users/caishanghong/Shopify/cli-tool/llxprt-code-3/packages/cli/src/ui/components/messages/ShellToolMessage.tsx): Remove `@ts-expect-error`
    - [x] [packages/cli/src/ui/hooks/shellCommandProcessor.ts](file:///Users/caishanghong/Shopify/cli-tool/gemini-cli/packages/cli/src/ui/hooks/shellCommandProcessor.ts): Add [getEnableInteractiveShell](file:///Users/caishanghong/Shopify/cli-tool/gemini-cli/packages/core/src/config/config.ts#1266-1269) to [Config](file:///Users/caishanghong/Shopify/cli-tool/gemini-cli/packages/core/src/config/config.ts#309-1537) interface
    - [x] [packages/core/src/config/config.ts](file:///Users/caishanghong/Shopify/cli-tool/gemini-cli/packages/core/src/config/config.ts): Ensure [ShellExecutionConfig](file:///Users/caishanghong/Shopify/cli-tool/llxprt-code-3/packages/core/src/config/config.ts#1512-1515) fields are handled
    - [-] [packages/cli/src/config/settingsSchema.ts](file:///Users/caishanghong/Shopify/cli-tool/gemini-cli/packages/cli/src/config/settingsSchema.ts): Remove duplicate `preferredEditor` (Deferred: Required for build compatibility, added TODO)
    - [x] [packages/cli/src/ui/components/Composer.tsx](file:///Users/caishanghong/Shopify/cli-tool/gemini-cli/packages/cli/src/ui/components/Composer.tsx): Verify placeholder values (confirmed dynamic/state-based)t <!-- id: 16 -->
    - [x] Add error handling to [useGeminiStream.ts](file:///Users/caishanghong/Shopify/cli-tool/gemini-cli/packages/cli/src/ui/hooks/useGeminiStream.ts) <!-- id: 17 -->
    - [x] Fix [MainContent.tsx](file:///Users/caishanghong/Shopify/cli-tool/gemini-cli/packages/cli/src/ui/components/MainContent.tsx) non-unique IDs <!-- id: 18 -->
    - [x] Fix [keyToAnsi.ts](file:///Users/caishanghong/Shopify/cli-tool/gemini-cli/packages/cli/src/ui/hooks/keyToAnsi.ts) copyright header <!-- id: 19 -->
    - [x] Fix [ui-sizing.ts](file:///Users/caishanghong/Shopify/cli-tool/gemini-cli/packages/cli/src/ui/utils/ui-sizing.ts) width calculation bug <!-- id: 20 -->
    - [x] Fix UI stability regression in [ToolGroupMessage.tsx](file:///Users/caishanghong/Shopify/cli-tool/gemini-cli/packages/cli/src/ui/components/messages/ToolGroupMessage.tsx) <!-- id: 23 -->
- [x] Resolve merge conflicts in [packages/core/src/config/config.ts](file:///Users/caishanghong/Shopify/cli-tool/gemini-cli/packages/core/src/config/config.ts) <!-- id: 25 -->
- [x] Resolve merge conflicts in [packages/cli/src/ui/AppContainer.tsx](file:///Users/caishanghong/Shopify/cli-tool/gemini-cli/packages/cli/src/ui/AppContainer.tsx) <!-- id: 26 -->
- [x] Resolve merge conflicts in [packages/cli/src/ui/components/HistoryItemDisplay.tsx](file:///Users/caishanghong/Shopify/cli-tool/gemini-cli/packages/cli/src/ui/components/HistoryItemDisplay.tsx) <!-- id: 27 -->
- [x] Resolve merge conflicts in [packages/cli/src/ui/contexts/UIStateContext.tsx](file:///Users/caishanghong/Shopify/cli-tool/gemini-cli/packages/cli/src/ui/contexts/UIStateContext.tsx) <!-- id: 28 -->
- [x] Resolve merge conflicts in [packages/cli/src/ui/layouts/DefaultAppLayout.tsx](file:///Users/caishanghong/Shopify/cli-tool/llxprt-code-3/packages/cli/src/ui/layouts/DefaultAppLayout.tsx) <!-- id: 29 -->
- [x] Resolve merge conflicts in [packages/cli/src/config/settings.test.ts](file:///Users/caishanghong/Shopify/cli-tool/llxprt-code-3/packages/cli/src/config/settings.test.ts) <!-- id: 30 -->
- [x] Verify merge resolution (Lint, Typecheck, Test) <!-- id: 31 -->
