#!/bin/bash
# å§”æ´¾ ClawHub å„ªåŒ–ä»»å‹™çµ¦ OpenCodeï¼ˆæ·±åº¦åˆ†æç‰ˆæœ¬ï¼‰

SCRIPT_DIR="$(cd "$(dirname "${BASH_SOURCE[0]}")" && pwd)"
REPORT_DIR="$HOME/.openclaw/workspace/docs"

log() {
    echo "[$(date -u +%Y-%m-%dT%H:%M:%SZ)] $*"
}

main() {
    log "=== å§”æ´¾ ClawHub å„ªåŒ–åˆ†æä»»å‹™çµ¦ OpenCode ==="

    # ä½¿ç”¨ opencode run å§”æ´¾ä»»å‹™
    # æ³¨æ„ï¼šé€™éœ€è¦åœ¨ PTY æ¨¡å¼ä¸‹åŸ·è¡Œ
    opencode run <<'EOFPROMPT'
ä½œç‚º OpenClaw ç³»çµ±å„ªåŒ–é¡§å•ï¼Œè«‹åŸ·è¡Œä»¥ä¸‹ä»»å‹™ï¼š

## ä»»å‹™ 1: æª¢æŸ¥å·²å®‰è£çš„ Moltbot æŠ€èƒ½

è®€å–ä»¥ä¸‹æª”æ¡ˆä¸¦æ‘˜è¦æœ€é—œéµçš„ 5 æ¢å»ºè­°ï¼š
- ~/.openclaw/workspace/skills/moltbot-best-practices/SKILL.md
- ~/.openclaw/workspace/skills/moltbot-security/SKILL.md
- ~/.openclaw/workspace/skills/moltcheck/SKILL.md

## ä»»å‹™ 2: æœå°‹ ClawHub æ–°æŠ€èƒ½

ä½¿ç”¨ä»¥ä¸‹å‘½ä»¤æœå°‹ç›¸é—œæŠ€èƒ½ï¼š
- npx clawhub search optimization
- npx clawhub search automation
- npx clawhub search monitoring

æ‰¾åˆ°è©•åˆ†å‰ 5 çš„ç›¸é—œæŠ€èƒ½

## ä»»å‹™ 3: åˆ†æç•¶å‰ç³»çµ±é…ç½®

åˆ†æä»¥ä¸‹æ–‡ä»¶çš„å®‰å…¨ç‹€æ…‹ï¼š
- ~/.openclaw/openclaw.json (Gateway é…ç½®)
- ~/.openclaw/openclaw.json æª”æ¡ˆæ¬Šé™

ç¢ºèªä»¥ä¸‹é …ç›®ï¼š
1. Gateway æ˜¯å¦ç¶å®šåˆ° loopbackï¼Ÿ
2. æ˜¯å¦è¨­ç½®äº† auth tokenï¼Ÿ
3. æ–‡ä»¶æ¬Šé™æ˜¯å¦å®‰å…¨ï¼Ÿï¼ˆ600/700ï¼‰

## ä»»å‹™ 4: ç”Ÿæˆå„ªåŒ–å ±å‘Š

å‰µå»º ~/.openclaw/workspace/docs/clawhub-optimization-recommendations.md

å ±å‘Šæ ¼å¼ï¼š

# OpenClaw ç³»çµ±å„ªåŒ–å»ºè­°å ±å‘Š
*ç”Ÿæˆæ™‚é–“: [UTC æ™‚é–“]*

---

## ğŸ“Š ç™¼ç¾çš„æ–° Top 5 æŠ€èƒ½

åˆ—å‡ºè©•åˆ†æœ€é«˜çš„ 5 å€‹ç›¸é—œæŠ€èƒ½åŠå…¶ç”¨é€”

---

## ğŸ“‹ Moltbot æŠ€èƒ½æ ¸å¿ƒå»ºè­°

æ‘˜è¦æ¯å€‹æŠ€èƒ½æœ€é—œéµçš„ 5 æ¢å»ºè­°

### æœ€ä½³å¯¦è¸

1. [å»ºè­° 1]
2. [å»ºè­° 2]
...

### å®‰å…¨åŠ å›º

1. [å»ºè­° 1]
2. [å»ºè­° 2]
...

---

## ğŸ”’ å®‰å…¨ç‹€æ…‹è©•ä¼°

æ ¹æ“šé…ç½®åˆ†æï¼Œçµ¦å‡ºï¼š
- âœ… å·²å¯¦æ–½çš„å®‰å…¨æªæ–½
- âš ï¸ éœ€è¦æ”¹é€²çš„å®‰å…¨å•é¡Œ
- ğŸ”» ç¼ºå°‘çš„å®‰å…¨é…ç½®

---

## ğŸ’¡ å…·é«”å„ªåŒ–å»ºè­°

### ğŸ”´ é«˜å„ªå…ˆç´šï¼ˆç«‹å³è™•ç†ï¼‰

- [ ] [å…·é«”è¡Œå‹• 1]
- [ ] [å…·é«”è¡Œå‹• 2]

### ğŸŸ¡ ä¸­å„ªå…ˆç´šï¼ˆæœ¬é€±è™•ç†ï¼‰

- [ ] [å…·é«”è¡Œå‹• 1]
- [ ] [å…·é«”è¡Œå‹• 2]

### ğŸŸ¢ ä½å„ªå…ˆç´šï¼ˆæœ‰ç©ºè™•ç†ï¼‰

- [ ] [å…·é«”è¡Œå‹• 1]

---

## ğŸ¯ å¿«é€Ÿé–‹å§‹

é¸æ“‡ 1-2 å€‹æœ€é‡è¦çš„è¡Œå‹•ï¼Œçµ¦å‡ºå…·é«”åŸ·è¡Œå‘½ä»¤æˆ–æ­¥é©Ÿ

---

**ä¸‹æ¬¡åˆ†æ**: 5 å°æ™‚å¾Œ

## ä»»å‹™ 5: é€šçŸ¥

å®Œæˆå¾Œï¼Œä½¿ç”¨ä»¥ä¸‹æŒ‡ä»¤é€šçŸ¥ä¸»æœƒè©±ï¼š

```
openclaw message send --target=main "ğŸ“Š ClawHub å„ªåŒ–å ±å‘Šå·²å®Œæˆï¼

å ±å‘Šä½ç½®ï¼š~/.openclaw/workspace/docs/clawhub-optimization-recommendations.md

é‡é»ç™¼ç¾ï¼š
1. ç™¼ç¾ X å€‹å¯èƒ½æœ‰ç”¨çš„æ–°æŠ€èƒ½
2. Y å€‹å®‰å…¨å•é¡Œéœ€è¦ä¿®å¾©
3. Z æ¢å„ªåŒ–å»ºè­°

è©³ç´°å…§å®¹è«‹æŸ¥çœ‹å ±å‘Šã€‚"
```

EOFPROMPT

    log "=== ä»»å‹™å·²å§”æ´¾ï¼Œç­‰å¾… OpenCode å®Œæˆ ==="
}

# åˆ¤æ–·æ˜¯ç”¨è…³æœ¬ç‰ˆæœ¬é‚„æ˜¯ OpenCode ç‰ˆæœ¬
if [ "$1" = "--opencode" ]; then
    main
else
    # ä¸¦è¡ŒåŸ·è¡Œï¼šè…³æœ¬ç‰ˆæœ¬ + OpenCode ç‰ˆæœ¬
    log "=== åŒæ™‚åŸ·è¡Œè…³æœ¬ç‰ˆæœ¬å’Œ OpenCode ç‰ˆæœ¬ ==="
    bash "$SCRIPT_DIR/clawhub-optimization-check.sh" &
    bash "$0" --opencode &
    wait
    log "=== å…©å€‹ç‰ˆæœ¬éƒ½å®Œæˆäº† ==="
fi
